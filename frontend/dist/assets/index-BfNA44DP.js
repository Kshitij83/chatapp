import{r as ve,a as je}from"./vendor-CvRECnwm.js";import{r as u,L as ie,R as te,u as ce,a as we,b as $,N as F,B as Ne}from"./router-B5GvP-ys.js";import{G as C}from"./icons-B01K53oS.js";import{l as Ce}from"./socket-TjCxX7sJ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();var W={exports:{}},z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var se;function Se(){if(se)return z;se=1;var e=ve(),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(i,d,m){var c,p={},h=null,f=null;m!==void 0&&(h=""+m),d.key!==void 0&&(h=""+d.key),d.ref!==void 0&&(f=d.ref);for(c in d)n.call(d,c)&&!a.hasOwnProperty(c)&&(p[c]=d[c]);if(i&&i.defaultProps)for(c in d=i.defaultProps,d)p[c]===void 0&&(p[c]=d[c]);return{$$typeof:s,type:i,key:h,ref:f,props:p,_owner:r.current}}return z.Fragment=o,z.jsx=l,z.jsxs=l,z}var oe;function ke(){return oe||(oe=1,W.exports=Se()),W.exports}var t=ke(),J={},re;function De(){if(re)return J;re=1;var e=je();return J.createRoot=e.createRoot,J.hydrateRoot=e.hydrateRoot,J}var Ae=De();function Me(e){return C({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function Z(e){return C({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(e)}function K(e){return C({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}function Be(e){return C({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function Pe(e){return C({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M43.246 466.142c-58.43-60.289-57.341-157.511 1.386-217.581L254.392 34c44.316-45.332 116.351-45.336 160.671 0 43.89 44.894 43.943 117.329 0 162.276L232.214 383.128c-29.855 30.537-78.633 30.111-107.982-.998-28.275-29.97-27.368-77.473 1.452-106.953l143.743-146.835c6.182-6.314 16.312-6.422 22.626-.241l22.861 22.379c6.315 6.182 6.422 16.312.241 22.626L171.427 319.927c-4.932 5.045-5.236 13.428-.648 18.292 4.372 4.634 11.245 4.711 15.688.165l182.849-186.851c19.613-20.062 19.613-52.725-.011-72.798-19.189-19.627-49.957-19.637-69.154 0L90.39 293.295c-34.763 35.56-35.299 93.12-1.191 128.313 34.01 35.093 88.985 35.137 123.058.286l172.06-175.999c6.177-6.319 16.307-6.433 22.626-.256l22.877 22.364c6.319 6.177 6.434 16.307.256 22.626l-172.06 175.998c-59.576 60.938-155.943 60.216-214.77-.485z"},child:[]}]})(e)}const de=u.createContext(),S=()=>u.useContext(de),Re=({children:e})=>{const[s,o]=u.useState(JSON.parse(localStorage.getItem("chat-user"))||null);return t.jsx(de.Provider,{value:{authUser:s,setAuthUser:o},children:e})};let Le={data:""},ze=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Le,Ie=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Oe=/\/\*[^]*?\*\/|  +/g,ae=/\n+/g,k=(e,s)=>{let o="",n="",r="";for(let a in e){let l=e[a];a[0]=="@"?a[1]=="i"?o=a+" "+l+";":n+=a[1]=="f"?k(l,a):a+"{"+k(l,a[1]=="k"?"":s)+"}":typeof l=="object"?n+=k(l,s?s.replace(/([^,])+/g,i=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,i):i?i+" "+d:d)):a):l!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=k.p?k.p(a,l):a+":"+l+";")}return o+(s&&r?s+"{"+r+"}":r)+n},w={},ue=e=>{if(typeof e=="object"){let s="";for(let o in e)s+=o+ue(e[o]);return s}return e},Te=(e,s,o,n,r)=>{let a=ue(e),l=w[a]||(w[a]=(d=>{let m=0,c=11;for(;m<d.length;)c=101*c+d.charCodeAt(m++)>>>0;return"go"+c})(a));if(!w[l]){let d=a!==e?e:(m=>{let c,p,h=[{}];for(;c=Ie.exec(m.replace(Oe,""));)c[4]?h.shift():c[3]?(p=c[3].replace(ae," ").trim(),h.unshift(h[0][p]=h[0][p]||{})):h[0][c[1]]=c[2].replace(ae," ").trim();return h[0]})(e);w[l]=k(r?{["@keyframes "+l]:d}:d,o?"":"."+l)}let i=o&&w.g?w.g:null;return o&&(w.g=w[l]),((d,m,c,p)=>{p?m.data=m.data.replace(p,d):m.data.indexOf(d)===-1&&(m.data=c?d+m.data:m.data+d)})(w[l],s,n,i),l},_e=(e,s,o)=>e.reduce((n,r,a)=>{let l=s[a];if(l&&l.call){let i=l(o),d=i&&i.props&&i.props.className||/^go/.test(i)&&i;l=d?"."+d:i&&typeof i=="object"?i.props?"":k(i,""):i===!1?"":i}return n+r+(l??"")},"");function G(e){let s=this||{},o=e.call?e(s.p):e;return Te(o.unshift?o.raw?_e(o,[].slice.call(arguments,1),s.p):o.reduce((n,r)=>Object.assign(n,r&&r.call?r(s.p):r),{}):o,ze(s.target),s.g,s.o,s.k)}let me,Q,X;G.bind({g:1});let N=G.bind({k:1});function Ue(e,s,o,n){k.p=s,me=e,Q=o,X=n}function D(e,s){let o=this||{};return function(){let n=arguments;function r(a,l){let i=Object.assign({},a),d=i.className||r.className;o.p=Object.assign({theme:Q&&Q()},i),o.o=/ *go\d+/.test(d),i.className=G.apply(o,n)+(d?" "+d:"");let m=e;return e[0]&&(m=i.as||e,delete i.as),X&&m[0]&&X(i),me(m,i)}return r}}var $e=e=>typeof e=="function",Y=(e,s)=>$e(e)?e(s):e,Fe=(()=>{let e=0;return()=>(++e).toString()})(),pe=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");e=!s||s.matches}return e}})(),Je=20,he=(e,s)=>{switch(s.type){case 0:return{...e,toasts:[s.toast,...e.toasts].slice(0,Je)};case 1:return{...e,toasts:e.toasts.map(a=>a.id===s.toast.id?{...a,...s.toast}:a)};case 2:let{toast:o}=s;return he(e,{type:e.toasts.find(a=>a.id===o.id)?1:0,toast:o});case 3:let{toastId:n}=s;return{...e,toasts:e.toasts.map(a=>a.id===n||n===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return s.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(a=>a.id!==s.toastId)};case 5:return{...e,pausedAt:s.time};case 6:let r=s.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+r}))}}},H=[],V={toasts:[],pausedAt:void 0},P=e=>{V=he(V,e),H.forEach(s=>{s(V)})},qe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},He=(e={})=>{let[s,o]=u.useState(V);u.useEffect(()=>(H.push(o),()=>{let r=H.indexOf(o);r>-1&&H.splice(r,1)}),[s]);let n=s.toasts.map(r=>{var a,l,i;return{...e,...e[r.type],...r,removeDelay:r.removeDelay||((a=e[r.type])==null?void 0:a.removeDelay)||(e==null?void 0:e.removeDelay),duration:r.duration||((l=e[r.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||qe[r.type],style:{...e.style,...(i=e[r.type])==null?void 0:i.style,...r.style}}});return{...s,toasts:n}},Ve=(e,s="blank",o)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...o,id:(o==null?void 0:o.id)||Fe()}),O=e=>(s,o)=>{let n=Ve(s,e,o);return P({type:2,toast:n}),n.id},E=(e,s)=>O("blank")(e,s);E.error=O("error");E.success=O("success");E.loading=O("loading");E.custom=O("custom");E.dismiss=e=>{P({type:3,toastId:e})};E.remove=e=>P({type:4,toastId:e});E.promise=(e,s,o)=>{let n=E.loading(s.loading,{...o,...o==null?void 0:o.loading});return typeof e=="function"&&(e=e()),e.then(r=>{let a=s.success?Y(s.success,r):void 0;return a?E.success(a,{id:n,...o,...o==null?void 0:o.success}):E.dismiss(n),r}).catch(r=>{let a=s.error?Y(s.error,r):void 0;a?E.error(a,{id:n,...o,...o==null?void 0:o.error}):E.dismiss(n)}),e};var Ye=(e,s)=>{P({type:1,toast:{id:e,height:s}})},Ge=()=>{P({type:5,time:Date.now()})},I=new Map,We=1e3,Ze=(e,s=We)=>{if(I.has(e))return;let o=setTimeout(()=>{I.delete(e),P({type:4,toastId:e})},s);I.set(e,o)},Ke=e=>{let{toasts:s,pausedAt:o}=He(e);u.useEffect(()=>{if(o)return;let a=Date.now(),l=s.map(i=>{if(i.duration===1/0)return;let d=(i.duration||0)+i.pauseDuration-(a-i.createdAt);if(d<0){i.visible&&E.dismiss(i.id);return}return setTimeout(()=>E.dismiss(i.id),d)});return()=>{l.forEach(i=>i&&clearTimeout(i))}},[s,o]);let n=u.useCallback(()=>{o&&P({type:6,time:Date.now()})},[o]),r=u.useCallback((a,l)=>{let{reverseOrder:i=!1,gutter:d=8,defaultPosition:m}=l||{},c=s.filter(f=>(f.position||m)===(a.position||m)&&f.height),p=c.findIndex(f=>f.id===a.id),h=c.filter((f,A)=>A<p&&f.visible).length;return c.filter(f=>f.visible).slice(...i?[h+1]:[0,h]).reduce((f,A)=>f+(A.height||0)+d,0)},[s]);return u.useEffect(()=>{s.forEach(a=>{if(a.dismissed)Ze(a.id,a.removeDelay);else{let l=I.get(a.id);l&&(clearTimeout(l),I.delete(a.id))}})},[s]),{toasts:s,handlers:{updateHeight:Ye,startPause:Ge,endPause:n,calculateOffset:r}}},Qe=N`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Xe=N`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,et=N`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,tt=D("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Qe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Xe} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${et} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,st=N`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ot=D("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${st} 1s linear infinite;
`,rt=N`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,at=N`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,nt=D("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${rt} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${at} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,lt=D("div")`
  position: absolute;
`,it=D("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,ct=N`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,dt=D("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${ct} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ut=({toast:e})=>{let{icon:s,type:o,iconTheme:n}=e;return s!==void 0?typeof s=="string"?u.createElement(dt,null,s):s:o==="blank"?null:u.createElement(it,null,u.createElement(ot,{...n}),o!=="loading"&&u.createElement(lt,null,o==="error"?u.createElement(tt,{...n}):u.createElement(nt,{...n})))},mt=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,pt=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,ht="0%{opacity:0;} 100%{opacity:1;}",ft="0%{opacity:1;} 100%{opacity:0;}",gt=D("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,xt=D("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,bt=(e,s)=>{let o=e.includes("top")?1:-1,[n,r]=pe()?[ht,ft]:[mt(o),pt(o)];return{animation:s?`${N(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${N(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},yt=u.memo(({toast:e,position:s,style:o,children:n})=>{let r=e.height?bt(e.position||s||"top-center",e.visible):{opacity:0},a=u.createElement(ut,{toast:e}),l=u.createElement(xt,{...e.ariaProps},Y(e.message,e));return u.createElement(gt,{className:e.className,style:{...r,...o,...e.style}},typeof n=="function"?n({icon:a,message:l}):u.createElement(u.Fragment,null,a,l))});Ue(u.createElement);var Et=({id:e,className:s,style:o,onHeightUpdate:n,children:r})=>{let a=u.useCallback(l=>{if(l){let i=()=>{let d=l.getBoundingClientRect().height;n(e,d)};i(),new MutationObserver(i).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return u.createElement("div",{ref:a,className:s,style:o},r)},vt=(e,s)=>{let o=e.includes("top"),n=o?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:pe()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(o?1:-1)}px)`,...n,...r}},jt=G`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,q=16,wt=({reverseOrder:e,position:s="top-center",toastOptions:o,gutter:n,children:r,containerStyle:a,containerClassName:l})=>{let{toasts:i,handlers:d}=Ke(o);return u.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:q,left:q,right:q,bottom:q,pointerEvents:"none",...a},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},i.map(m=>{let c=m.position||s,p=d.calculateOffset(m,{reverseOrder:e,gutter:n,defaultPosition:s}),h=vt(c,p);return u.createElement(Et,{id:m.id,key:m.id,onHeightUpdate:d.updateHeight,className:m.visible?jt:"",style:h},m.type==="custom"?Y(m.message,m):r?r(m):u.createElement(yt,{toast:m,position:c}))}))},y=E;const Nt=()=>{const[e,s]=u.useState(!1),{setAuthUser:o}=S();return{loading:e,login:async(r,a)=>{if(Ct({username:r,password:a})){s(!0);try{const d=await(await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r,password:a})})).json();if(d.error)throw new Error(d.error);localStorage.setItem("chat-user",JSON.stringify(d)),o(d)}catch(i){y.error(i.message)}finally{s(!1)}}}}};function Ct({username:e,password:s}){return!e||!s?(y.error("Please fill in all fields"),!1):!0}const St=()=>{const[e,s]=u.useState(""),[o,n]=u.useState(""),[r,a]=u.useState(!1),{loading:l,login:i}=Nt(),d=async m=>{m.preventDefault(),await i(e,o)};return t.jsx("div",{className:"standard-window flex flex-col items-center justify-center chat-window-bg rounded-2xl shadow-2xl",children:t.jsxs("div",{className:"w-full max-w-md p-8 mx-4",children:[t.jsxs("h1",{className:"text-4xl font-bold text-center mb-8",style:{color:"#EEEEEE"},children:["Login to",t.jsx("span",{style:{color:"#00ADB5"},className:"ml-2",children:"JustChatting"})]}),t.jsxs("form",{onSubmit:d,className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Username"}),t.jsx("input",{type:"text",placeholder:"Enter username",className:"w-full input h-12",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:e,onChange:m=>s(m.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Password"}),t.jsxs("div",{className:"password-input-container",children:[t.jsx("input",{type:r?"text":"password",placeholder:"Enter Password",className:"w-full input h-12 pr-12",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:o,onChange:m=>n(m.target.value)}),t.jsx("button",{type:"button",className:"password-toggle",onClick:()=>a(!r),children:r?t.jsx(Z,{size:18}):t.jsx(K,{size:18})})]})]}),t.jsx(ie,{to:"/signup",className:"text-sm hover:underline mt-4 inline-block",style:{color:"#00ADB5"},children:"Don't have an account?"}),t.jsx("div",{children:t.jsx("button",{className:"btn w-full font-semibold border-none h-12 btn-animated",style:{backgroundColor:"#00ADB5",color:"#222831"},disabled:l,children:l?t.jsx("span",{className:"loading loading-spinner"}):"Login"})})]})]})})},kt=({onCheckboxChange:e,selectedGender:s})=>t.jsxs("div",{className:"flex gap-6 mt-4",children:[t.jsx("div",{className:"form-control",children:t.jsxs("label",{className:"label gap-3 cursor-pointer",style:{color:s==="male"?"#00ADB5":"#EEEEEE"},children:[t.jsx("span",{className:"label-text text-sm font-medium",children:"Male"}),t.jsx("input",{type:"checkbox",className:"checkbox",style:{borderColor:"#00ADB5",backgroundColor:s==="male"?"#00ADB5":"transparent"},checked:s==="male",onChange:()=>e("male")})]})}),t.jsx("div",{className:"form-control",children:t.jsxs("label",{className:"label gap-3 cursor-pointer",style:{color:s==="female"?"#00ADB5":"#EEEEEE"},children:[t.jsx("span",{className:"label-text text-sm font-medium",children:"Female"}),t.jsx("input",{type:"checkbox",className:"checkbox",style:{borderColor:"#00ADB5",backgroundColor:s==="female"?"#00ADB5":"transparent"},checked:s==="female",onChange:()=>e("female")})]})})]}),Dt=()=>{const[e,s]=u.useState(!1),{setAuthUser:o}=S();return{loading:e,signup:async({fullName:r,username:a,password:l,confirmPassword:i,gender:d})=>{if(At({fullName:r,username:a,password:l,confirmPassword:i,gender:d})){s(!0);try{const p=await(await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:r,username:a,password:l,confirmPassword:i,gender:d})})).json();if(p.error)throw new Error(p.error);localStorage.setItem("chat-user",JSON.stringify(p)),o(p),console.log(p)}catch(c){y.error(c.message)}finally{s(!1)}}}}};function At({fullName:e,username:s,password:o,confirmPassword:n,gender:r}){return!e||!s||!o||!n||!r?(y.error("Please fill in all fields"),!1):o!==n?(y.error("Passwords do not match"),!1):o.length<6?(y.error("Password should be minimum 6 characters"),!1):!0}const Mt=()=>{const[e,s]=u.useState({fullName:"",username:"",password:"",confirmPassword:"",gender:""}),[o,n]=u.useState(!1),[r,a]=u.useState(!1),{loading:l,signup:i}=Dt(),d=c=>{s({...e,gender:c})},m=async c=>{c.preventDefault(),await i(e)};return t.jsx("div",{className:"standard-window flex flex-col items-center justify-center chat-window-bg rounded-2xl shadow-2xl",children:t.jsxs("div",{className:"w-full max-w-md p-8 mx-4 overflow-y-auto",children:[t.jsxs("h1",{className:"text-3xl font-bold text-center mb-6",style:{color:"#EEEEEE"},children:["Sign Up for",t.jsx("span",{style:{color:"#00ADB5"},className:"ml-2",children:"JustChatting"})]}),t.jsxs("form",{onSubmit:m,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Full Name"}),t.jsx("input",{type:"text",placeholder:"Enter your full name",className:"w-full input h-12",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:e.fullName,onChange:c=>s({...e,fullName:c.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Username"}),t.jsx("input",{type:"text",placeholder:"Enter username",className:"w-full input h-12",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:e.username,onChange:c=>s({...e,username:c.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Password"}),t.jsxs("div",{className:"password-input-container",children:[t.jsx("input",{type:o?"text":"password",placeholder:"Enter Password",className:"w-full input h-12 pr-12",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:e.password,onChange:c=>s({...e,password:c.target.value})}),t.jsx("button",{type:"button",className:"password-toggle",onClick:()=>n(!o),children:o?t.jsx(Z,{size:18}):t.jsx(K,{size:18})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Confirm Password"}),t.jsxs("div",{className:"password-input-container",children:[t.jsx("input",{type:r?"text":"password",placeholder:"Confirm Password",className:"w-full input h-12 pr-12",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:e.confirmPassword,onChange:c=>s({...e,confirmPassword:c.target.value})}),t.jsx("button",{type:"button",className:"password-toggle",onClick:()=>a(!r),children:r?t.jsx(Z,{size:18}):t.jsx(K,{size:18})})]})]}),t.jsx(kt,{onCheckboxChange:d,selectedGender:e.gender}),t.jsx(ie,{to:"/login",className:"text-sm hover:underline mt-4 inline-block",style:{color:"#00ADB5"},children:"Already have an account?"}),t.jsx("div",{children:t.jsx("button",{className:"btn w-full font-semibold border-none h-12 btn-animated",style:{backgroundColor:"#00ADB5",color:"#222831"},disabled:l,children:l?t.jsx("span",{className:"loading loading-spinner"}):"Sign Up"})})]})]})})};function Bt(e){return C({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 428 339.92 303.9a160.48 160.48 0 0 0 30.72-94.58C370.64 120.37 298.27 48 209.32 48S48 120.37 48 209.32s72.37 161.32 161.32 161.32a160.48 160.48 0 0 0 94.58-30.72L428 464zM209.32 319.69a110.38 110.38 0 1 1 110.37-110.37 110.5 110.5 0 0 1-110.37 110.37z"},child:[]}]})(e)}const Pt=e=>{let s;const o=new Set,n=(m,c)=>{const p=typeof m=="function"?m(s):m;if(!Object.is(p,s)){const h=s;s=c??(typeof p!="object"||p===null)?p:Object.assign({},s,p),o.forEach(f=>f(s,h))}},r=()=>s,i={setState:n,getState:r,getInitialState:()=>d,subscribe:m=>(o.add(m),()=>o.delete(m))},d=s=e(n,r,i);return i},Rt=e=>Pt(e),Lt=e=>e;function zt(e,s=Lt){const o=te.useSyncExternalStore(e.subscribe,()=>s(e.getState()),()=>s(e.getInitialState()));return te.useDebugValue(o),o}const It=e=>{const s=Rt(e),o=n=>zt(s,n);return Object.assign(o,s),o},Ot=e=>It(e),R=Ot(e=>({selectedConversation:null,setSelectedConversation:s=>e({selectedConversation:s}),messages:[],setMessages:s=>e({messages:s})})),fe=()=>{const[e,s]=u.useState(!1),[o,n]=u.useState([]);return u.useEffect(()=>{(async()=>{s(!0);try{const l=await(await fetch("/api/users")).json();if(l.error)throw new Error(l.error);n(l)}catch(a){y.error(a.message)}finally{s(!1)}})()},[]),{loading:e,conversations:o}},Tt=()=>{const[e,s]=u.useState(""),{setSelectedConversation:o}=R(),{conversations:n}=fe(),r=a=>{if(a.preventDefault(),!e)return;if(e.length<3)return y.error("Search term must be at least 3 characters long");const l=n.find(i=>i.fullName.toLowerCase().includes(e.toLowerCase()));l?(o(l),s("")):y.error("No such user found!")};return t.jsxs("form",{onSubmit:r,className:"flex items-center gap-2 mb-4",children:[t.jsx("input",{type:"text",placeholder:"Search...",className:"input rounded-lg flex-1 text-sm",style:{backgroundColor:"#222831",borderColor:"#00ADB5",color:"#EEEEEE","--placeholder-color":"#EEEEEE"},value:e,onChange:a=>s(a.target.value)}),t.jsx("button",{type:"submit",className:"btn btn-circle btn-sm border-none",style:{backgroundColor:"#00ADB5",color:"#222831"},children:t.jsx(Bt,{className:"w-5 h-5"})})]})},ge=u.createContext(),xe=()=>u.useContext(ge),_t=({children:e})=>{const[s,o]=u.useState(null),[n,r]=u.useState([]),{authUser:a}=S();return u.useEffect(()=>{if(a){const l=Ce("https://justchatting-sdt6.onrender.com/",{query:{userId:a._id}});return o(l),l.on("getOnlineUsers",i=>{r(i)}),()=>l.close()}else s&&(s.close(),o(null))},[a]),t.jsx(ge.Provider,{value:{socket:s,onlineUsers:n},children:e})},Ut=({conversation:e,lastIdx:s,emoji:o})=>{const{selectedConversation:n,setSelectedConversation:r}=R(),a=(n==null?void 0:n._id)===e._id,{onlineUsers:l}=xe(),i=l.includes(e._id),d=c=>{},m=c=>{};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex gap-2 items-center rounded-lg p-2 cursor-pointer transition-colors",style:{backgroundColor:a?"#00ADB5":"#393E46",color:a?"#222831":"#EEEEEE"},onClick:()=>r(e),onMouseEnter:d,onMouseLeave:m,children:[t.jsx("div",{className:`avatar ${i?"online":""}`,children:t.jsx("div",{className:"w-10 rounded-full",style:{border:"3px solid #00ADB5"},children:t.jsx("img",{src:e.profilePic,alt:"user avatar"})})}),t.jsx("div",{className:"flex flex-col flex-1 min-w-0",children:t.jsxs("div",{className:"flex gap-2 justify-between items-center",children:[t.jsx("p",{className:"font-bold text-sm truncate",style:{color:a?"#222831":"#EEEEEE"},children:e.fullName}),t.jsx("span",{className:"text-lg flex-shrink-0",children:o})]})})]}),!s&&t.jsx("div",{className:"divider my-1 py-0 h-px",style:{backgroundColor:"#00ADB5"}})]})},ne=["ðŸ‘¾","â­","ðŸŒŸ","ðŸŽ‰","ðŸŽŠ","ðŸŽˆ","ðŸŽ","ðŸŽ‚","ðŸŽ„","ðŸŽƒ","ðŸŽ—","ðŸŽŸ","ðŸŽ«","ðŸŽ–","ðŸ†","ðŸ…","ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰","âš½","ðŸ€","ðŸˆ","âš¾","ðŸŽ¾","ðŸ","ðŸ‰","ðŸŽ±","ðŸ“","ðŸ¸","ðŸ¥…","ðŸ’","ðŸ‘","ðŸ","â›³","ðŸ¹","ðŸŽ£","ðŸ¥Š","ðŸ¥‹","ðŸŽ½","â›¸","ðŸ¥Œ","ðŸ›·","ðŸŽ¿","â›·","ðŸ‚","ðŸ‹ï¸","ðŸ¤¼","ðŸ¤¸","ðŸ¤º","â›¹ï¸","ðŸ¤¾","ðŸŒï¸","ðŸ‡","ðŸ§˜"],$t=()=>ne[Math.floor(Math.random()*ne.length)],Ft=()=>{const{loading:e,conversations:s}=fe();return console.log("CONVERSATIONS:",s),t.jsxs("div",{className:"py-2 flex flex-col overflow-auto",children:[s.map((o,n)=>t.jsx(Ut,{conversation:o,emoji:$t(),lastIdx:n===s.length-1},o._id)),e?t.jsx("span",{className:"loading loading-spinner"}):null]})};function Jt(e){return C({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16 13v-2H7V8l-5 4 5 4v-3z"},child:[]},{tag:"path",attr:{d:"M20 3h-9c-1.103 0-2 .897-2 2v4h2V5h9v14h-9v-4H9v4c0 1.103.897 2 2 2h9c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2z"},child:[]}]})(e)}const qt=()=>{const[e,s]=u.useState(!1),{setAuthUser:o}=S();return{loading:e,logout:async()=>{s(!0);try{const a=await(await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(a.error)throw new Error(a.error);localStorage.removeItem("chat-user"),o(null)}catch(r){y.error(r.message)}finally{s(!1)}}}},Ht=()=>{const{loading:e,logout:s}=qt();return t.jsx("div",{className:"mt-auto",children:e?t.jsx("span",{className:"loading loading-spinner",style:{color:"#00ADB5"}}):t.jsx(Jt,{className:"w-6 h-6 cursor-pointer transition-colors",style:{color:"#00ADB5"},onClick:s,onMouseEnter:o=>{o.target.style.color="#EEEEEE"},onMouseLeave:o=>{o.target.style.color="#00ADB5"}})})},Vt=()=>{const e=ce(),{authUser:s}=S(),o=r=>{r.currentTarget.style.backgroundColor="#1a1f25"},n=r=>{r.currentTarget.style.backgroundColor="#222831"};return t.jsxs("div",{className:"p-4 flex flex-col w-64 lg:w-72 xl:w-80",style:{borderRight:"2px solid #00ADB5",backgroundColor:"#393E46"},children:[t.jsxs("button",{className:"flex items-center gap-3 mb-6 p-4 rounded-lg font-semibold transition-colors btn-animated",style:{backgroundColor:"#222831",color:"#EEEEEE",border:"4px solid #00ADB5"},onClick:()=>e("/profile"),onMouseEnter:o,onMouseLeave:n,children:[t.jsx("img",{src:s.profilePic,alt:"profile",className:"w-10 h-10 rounded-full",style:{border:"3px solid #00ADB5"}}),t.jsx("span",{style:{color:"#00ADB5"},children:"Profile"})]}),t.jsx(Tt,{}),t.jsx("div",{className:"divider px-3",style:{borderColor:"#00ADB5"}}),t.jsx(Ft,{}),t.jsx(Ht,{})]})};function Yt(e){const s=new Date(e),o=le(s.getHours()),n=le(s.getMinutes());return`${o}:${n}`}function le(e){return e.toString().padStart(2,"0")}const Gt=({message:e})=>{const{authUser:s}=S(),{selectedConversation:o}=R(),n=e.senderId===s._id,r=Yt(e.createdAt||e.timestamp),a=n?"chat-end":"chat-start",l=n?s.profilePic:o==null?void 0:o.profilePic,i=n?"#00ADB5":"#393E46",d=n?"#222831":"#EEEEEE",m=e.shouldShake?"shake":"";let c;return e.messageType==="audio"?c=t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("audio",{controls:!0,className:"max-w-[300px]",preload:"metadata",style:{backgroundColor:n?"#222831":"#EEEEEE",borderRadius:"8px",outline:"none"},onError:p=>{console.error("Audio playback error:",p)},onLoadedMetadata:p=>{console.log("Audio loaded, duration:",p.target.duration)},children:[t.jsx("source",{src:e.message,type:"audio/webm"}),t.jsx("source",{src:e.message,type:"audio/mp4"}),t.jsx("source",{src:e.message,type:"audio/wav"}),t.jsx("source",{src:e.message,type:"audio/mpeg"}),"Your browser does not support the audio element."]}),e.fileName&&t.jsx("span",{className:"text-xs opacity-70",children:e.fileName})]}):e.messageType==="image"?c=t.jsx("img",{src:e.message,alt:e.fileName||"Image",className:"max-w-[250px] max-h-[250px] rounded-lg",style:{objectFit:"cover",border:"2px solid #00ADB5"}}):c=e.message,t.jsx(t.Fragment,{children:t.jsxs("div",{className:`chat ${a} mb-4`,children:[t.jsx("div",{className:"chat-image avatar",children:t.jsx("div",{className:"w-10 rounded-full",style:{border:"2px solid #00ADB5"},children:t.jsx("img",{alt:"User avatar",src:l})})}),t.jsx("div",{className:`chat-bubble ${m} max-w-xs font-medium`,style:{backgroundColor:i,color:d},children:c}),t.jsx("div",{className:"chat-footer opacity-70 text-xs flex gap-1 items-center",style:{color:"#EEEEEE"},children:r})]})})},Wt=()=>{const[e,s]=u.useState(!1),{messages:o,setMessages:n,selectedConversation:r}=R();return u.useEffect(()=>{const a=async()=>{s(!0);try{const i=await(await fetch(`/api/messages/${r._id}`)).json();if(i.error)throw new Error(i.error);n(i)}catch(l){y.error(l.message)}finally{s(!1)}};r!=null&&r._id&&a()},[r==null?void 0:r._id,n]),{messages:o,loading:e}},Zt=()=>t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex gap-3 items-center",children:[t.jsx("div",{className:"skeleton w-10 h-10 rounded-full shrink-0"}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("div",{className:"skeleton h-4 w-40"}),t.jsx("div",{className:"skeleton h-4 w-40"})]})]}),t.jsxs("div",{className:"flex gap-3 items-center justify-end",children:[t.jsx("div",{className:"flex flex-col gap-1",children:t.jsx("div",{className:"skeleton h-4 w-40"})}),t.jsx("div",{className:"skeleton w-10 h-10 rounded-full shrink-0"})]})]}),Kt="/assets/notification-qhDe3lRG.mp3",Qt=()=>{const{socket:e}=xe(),{messages:s,setMessages:o}=R();u.useEffect(()=>(e==null||e.on("newMessage",n=>{n.shouldShake=!0,new Audio(Kt).play(),o([...s,n])}),()=>e==null?void 0:e.off("newMessage")),[e,o,s])},Xt=()=>{const{messages:e,loading:s}=Wt();Qt();const o=u.useRef();return u.useEffect(()=>{setTimeout(()=>{var n;(n=o.current)==null||n.scrollIntoView({behavior:"smooth"})},100)},[e]),t.jsxs("div",{className:"px-4 flex-1 overflow-auto",children:[!s&&e.length>0&&e.map(n=>t.jsx("div",{ref:o,children:t.jsx(Gt,{message:n})},n._id)),s&&[...Array(3)].map((n,r)=>t.jsx(Zt,{},r)),!s&&e.length===0&&t.jsx("p",{className:"text-center",children:"Send a message to start the conversation"})]})};function es(e){return C({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"},child:[]}]})(e)}const ts=()=>{const[e,s]=u.useState(!1),{messages:o,setMessages:n,selectedConversation:r}=R();return{sendMessage:async(l,i="text",d="")=>{s(!0);try{const c=await(await fetch(`/api/messages/send/${r._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:l,messageType:i,fileName:d})})).json();if(c.error)throw new Error(c.error);n([...o,c])}catch(m){y.error(m.message)}finally{s(!1)}},loading:e}},ss=()=>{const[e,s]=u.useState(""),{loading:o,sendMessage:n}=ts(),[r,a]=u.useState(!1),[l,i]=u.useState(null),[d,m]=u.useState(null),[c,p]=u.useState(null),[h,f]=u.useState(null),A=u.useRef(),j=async()=>{try{console.log("Starting audio recording...");const x=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:48e3,sampleSize:16,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});console.log("Audio stream obtained");let b="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(b)||(b="audio/webm",MediaRecorder.isTypeSupported(b)||(b="audio/mp4",MediaRecorder.isTypeSupported(b)||(b="audio/wav"))),console.log("Using MIME type:",b);const L={mimeType:b,audioBitsPerSecond:128e3},M=new MediaRecorder(x,L);let T=[];M.ondataavailable=g=>{console.log("Data available:",g.data.size,"bytes"),g.data.size>0&&T.push(g.data)},M.onstop=async()=>{console.log("Recording stopped, total chunks:",T.length);try{if(T.length===0){console.error("No audio chunks recorded"),alert("No audio was recorded. Please try again.");return}const g=new Blob(T,{type:b});if(console.log("Created blob:",g.size,"bytes, type:",g.type),g.size===0){console.error("Audio blob is empty"),alert("Recording failed - no audio data captured.");return}const _=Date.now()-d;if(console.log("Recording duration:",_,"ms"),_<500){console.error("Recording too short"),alert("Recording too short. Please hold the button longer.");return}const U=new FileReader;U.onloadend=async()=>{try{const B=U.result;if(console.log("Base64 audio length:",B.length),!B||B.length<100){console.error("Base64 conversion failed or too small"),alert("Failed to process audio recording.");return}const ee=`audio_${Date.now()}.${b.includes("webm")?"webm":b.includes("mp4")?"mp4":"wav"}`;console.log("Sending audio with filename:",ee),await n(B,"audio",ee)}catch(B){console.error("Error sending audio:",B),alert("Failed to send audio message: "+B.message)}},U.onerror=()=>{console.error("FileReader error"),alert("Failed to process audio file.")},U.readAsDataURL(g)}catch(g){console.error("Error processing recording:",g),alert("Failed to process recording: "+g.message)}finally{x.getTracks().forEach(g=>{console.log("Stopping track:",g.kind),g.stop()}),i(null),a(!1),m(null)}},M.onerror=g=>{console.error("MediaRecorder error:",g.error),alert("Recording error: "+g.error),x.getTracks().forEach(_=>_.stop()),a(!1),m(null)},M.onstart=()=>{console.log("Recording started"),m(Date.now())},M.start(250),i(M),a(!0),console.log("MediaRecorder started, state:",M.state)}catch(x){console.error("Microphone access error:",x),alert("Microphone access denied or not available: "+x.message),a(!1),m(null)}},v=()=>{console.log("Mouse up event, recording:",r),l&&r&&l.state==="recording"&&(console.log("Stopping recording..."),l.stop())},be=x=>{const b=x.target.files[0];if(!b)return;if(!b.type.startsWith("image/")){alert("Only image files are allowed.");return}const L=new FileReader;L.onloadend=()=>{p(L.result),f(b)},L.readAsDataURL(b)},ye=async()=>{!c||!h||(await n(c,"image",h.name),p(null),f(null))},Ee=async x=>{x.preventDefault(),e&&(await n(e,"text"),s(""))};return t.jsxs("form",{className:"px-6 py-4",style:{backgroundColor:"#393E46",borderTop:"2px solid #00ADB5"},onSubmit:Ee,children:[c&&t.jsxs("div",{className:"flex items-center mb-4 p-4 rounded-lg max-w-2xl",style:{backgroundColor:"#222831"},children:[t.jsx("img",{src:c,alt:"Preview",className:"max-w-[150px] max-h-[150px] rounded-lg mr-4",style:{border:"2px solid #00ADB5"}}),t.jsx("button",{type:"button",className:"px-6 py-3 rounded-lg mr-3 font-semibold text-lg",style:{backgroundColor:"#00ADB5",color:"#222831"},onClick:ye,children:"Send Image"}),t.jsx("button",{type:"button",className:"px-6 py-3 rounded-lg font-semibold text-lg",style:{backgroundColor:"#dc2626",color:"#EEEEEE"},onClick:()=>{p(null),f(null)},children:"Cancel"})]}),t.jsxs("div",{className:"w-full relative flex items-center gap-4 max-w-4xl mx-auto",children:[t.jsx("input",{type:"text",className:"text-base rounded-lg block w-full p-4",style:{backgroundColor:"#222831",borderColor:"#00ADB5",border:"2px solid #00ADB5",color:"#EEEEEE"},placeholder:"Type your message...",value:e,onChange:x=>s(x.target.value)}),t.jsxs("button",{type:"button",className:"p-4 rounded-full transition-colors relative",style:{backgroundColor:r?"#dc2626":"transparent",border:r?"2px solid #EEEEEE":"2px solid transparent"},onMouseDown:j,onMouseUp:v,onMouseLeave:v,onTouchStart:j,onTouchEnd:v,title:r?"Recording... Release to send":"Hold to record audio",children:[t.jsx(Be,{color:r?"#EEEEEE":"#00ADB5",size:22}),r&&t.jsx("div",{className:"absolute -top-2 -right-2 w-3 h-3 bg-red-500 rounded-full animate-pulse"})]}),t.jsxs("label",{className:"p-4 rounded-full transition-colors cursor-pointer",title:"Send Image",onMouseEnter:x=>x.target.style.backgroundColor="#222831",onMouseLeave:x=>x.target.style.backgroundColor="transparent",children:[t.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},ref:A,onChange:be}),t.jsx(Pe,{color:"#00ADB5",size:22})]}),t.jsx("button",{type:"submit",className:"p-4 rounded-full transition-colors",style:{backgroundColor:"#00ADB5"},children:o?t.jsx("div",{className:"loading loading-spinner w-6 h-6"}):t.jsx(es,{color:"#222831",size:22})})]})]})};function os(e){return C({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M21 7h-3c0-1.65-1.35-3-3-3h-12c-1.65 0-3 1.35-3 3v7c0 1.65 1.35 3 3 3v3l3-3c0 1.65 1.35 3 3 3h8l3 3v-3h1c1.65 0 3-1.35 3-3v-7c0-1.65-1.35-3-3-3zm-18 8c-.542 0-1-.458-1-1v-7c0-.542.458-1 1-1h12c.542 0 1 .458 1 1v1h-6.5c-1.379 0-2.5 1.121-2.5 2.5v4.5h-4zm19 2c0 .542-.458 1-1 1h-12c-.542 0-1-.458-1-1v-6.5c0-.827.673-1.5 1.5-1.5h11.5c.542 0 1 .458 1 1v7z"},child:[]}]})(e)}const rs=()=>{const{selectedConversation:e,setSelectedConversation:s}=R();return u.useEffect(()=>()=>s(null),[s]),t.jsx("div",{className:"flex-1 flex flex-col min-w-0",style:{background:"linear-gradient(135deg, #222831 0%, #393E46 50%, #222831 100%)"},children:e?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"px-4 py-4 mb-2",style:{background:"linear-gradient(90deg, #393E46, #222831)",borderBottom:"2px solid #00ADB5"},children:[t.jsxs("span",{style:{color:"#00ADB5"},className:"font-medium",children:["Chatting with:"," "]}),t.jsx("span",{style:{color:"#EEEEEE"},className:"font-bold text-lg",children:e.fullName})]}),t.jsx(Xt,{}),t.jsx(ss,{})]}):t.jsx(as,{})})},as=()=>{const{authUser:e}=S();return t.jsx("div",{className:"flex items-center justify-center w-full h-full relative",style:{background:"linear-gradient(135deg, #222831 0%, #393E46 50%, #222831 100%)"},children:t.jsxs("div",{className:"px-4 text-center sm:text-lg md:text-xl font-semibold flex flex-col items-center gap-4",children:[t.jsxs("p",{className:"text-2xl",style:{color:"#EEEEEE"},children:["Welcome"," ",t.jsx("span",{style:{color:"#00ADB5"},children:e.fullName})," ðŸ‘‹"]}),t.jsx("p",{style:{color:"#EEEEEE"},children:"Select a chat to start messaging"}),t.jsx(os,{className:"text-6xl md:text-8xl animate-pulse",style:{color:"#00ADB5"}})]})})},ns=()=>t.jsxs("div",{className:"standard-window flex rounded-2xl overflow-hidden chat-window-bg shadow-2xl",children:[t.jsx(Vt,{}),t.jsx(rs,{})]}),ls=()=>{const{authUser:e,setAuthUser:s}=S(),[o,n]=u.useState(!1),[r,a]=u.useState(e.fullName),[l,i]=u.useState(e.username),[d,m]=u.useState(!1),[c,p]=u.useState(!1),h=ce(),f=async()=>{p(!0);try{const v=await(await fetch("/api/users/update-profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:r,username:l})})).json();if(v.error)throw new Error(v.error);s({...e,fullName:v.fullName,username:v.username}),localStorage.setItem("chat-user",JSON.stringify({...e,fullName:v.fullName,username:v.username})),y.success("Profile updated!"),n(!1)}catch(j){y.error(j.message)}finally{p(!1)}},A=async()=>{p(!0);try{const v=await(await fetch("/api/users/delete-account",{method:"DELETE",headers:{"Content-Type":"application/json"}})).json();if(v.error)throw new Error(v.error);localStorage.removeItem("chat-user"),s(null),y.success("Account deleted"),h("/login")}catch(j){y.error(j.message)}finally{p(!1),m(!1)}};return t.jsxs("div",{className:"profile-window rounded-2xl chat-window-bg shadow-2xl p-8 flex flex-col",children:[t.jsx("div",{className:"flex items-center justify-between mb-10",children:t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs("button",{className:"flex items-center gap-3 px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors btn-animated",onClick:()=>h("/"),style:{color:"#EEEEEE",borderColor:"#00ADB5"},children:[t.jsx(Me,{size:18}),t.jsx("span",{className:"text-lg font-medium",children:"Back to Chat"})]}),t.jsx("h1",{className:"text-4xl font-bold",style:{color:"#EEEEEE"},children:"My Profile"})]})}),t.jsx("div",{className:"flex-1 flex items-center justify-center",children:t.jsxs("div",{className:"w-full max-w-4xl grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[t.jsx("div",{className:"flex justify-center",children:t.jsx("img",{src:e.profilePic,alt:"profile",className:"w-40 h-40 lg:w-48 lg:h-48 rounded-full shadow-lg",style:{border:"4px solid #00ADB5"}})}),t.jsxs("div",{className:"space-y-6",children:[o?t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-3",style:{color:"#00ADB5"},children:"Full Name:"}),t.jsx("input",{className:"input w-full h-14 text-lg rounded-lg",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:r,onChange:j=>a(j.target.value),disabled:c,placeholder:"Enter your full name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-3",style:{color:"#00ADB5"},children:"Username:"}),t.jsx("input",{className:"input w-full h-14 text-lg rounded-lg",style:{backgroundColor:"#393E46",borderColor:"#00ADB5",color:"#EEEEEE"},value:l,onChange:j=>i(j.target.value),disabled:c,placeholder:"Enter your username"})]})]}):t.jsx(t.Fragment,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-6 rounded-lg",style:{backgroundColor:"#393E46"},children:[t.jsx("p",{className:"text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Full Name"}),t.jsx("p",{className:"text-2xl font-semibold",style:{color:"#EEEEEE"},children:e.fullName})]}),t.jsxs("div",{className:"p-6 rounded-lg",style:{backgroundColor:"#393E46"},children:[t.jsx("p",{className:"text-sm font-medium mb-2",style:{color:"#00ADB5"},children:"Username"}),t.jsxs("p",{className:"text-2xl font-semibold",style:{color:"#EEEEEE"},children:["@",e.username]})]})]})}),t.jsx("div",{className:"flex gap-4 pt-6",children:o?t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn border-none btn-animated flex-1 h-14 text-lg font-semibold rounded-lg",style:{backgroundColor:"#00ADB5",color:"#222831"},onClick:f,disabled:c,children:c?t.jsx("span",{className:"loading loading-spinner"}):"Save Changes"}),t.jsx("button",{className:"btn border-none btn-animated flex-1 h-14 text-lg font-semibold rounded-lg",style:{backgroundColor:"#393E46",color:"#EEEEEE"},onClick:()=>{n(!1),a(e.fullName),i(e.username)},disabled:c,children:"Cancel"})]}):t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn border-none btn-animated flex-1 h-14 text-lg font-semibold rounded-lg",style:{backgroundColor:"#00ADB5",color:"#222831"},onClick:()=>n(!0),children:"Edit Profile"}),t.jsx("button",{className:"btn border-none btn-animated flex-1 h-14 text-lg font-semibold rounded-lg",style:{backgroundColor:"#dc2626",color:"#EEEEEE"},onClick:()=>m(!0),children:"Delete Account"})]})})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 flex items-center justify-center modal-overlay",style:{backgroundColor:"rgba(34, 40, 49, 0.8)",zIndex:100},children:t.jsxs("div",{className:"rounded-xl p-8 flex flex-col items-center max-w-md w-full mx-4",style:{backgroundColor:"#222831",border:"2px solid #00ADB5",zIndex:101},children:[t.jsx("div",{className:"text-6xl mb-4",children:"âš ï¸"}),t.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:"#EEEEEE"},children:"Delete Account"}),t.jsx("p",{className:"text-center mb-6",style:{color:"#EEEEEE"},children:"This action cannot be undone. All your messages and data will be permanently deleted."}),t.jsxs("div",{className:"flex gap-4 w-full",children:[t.jsx("button",{className:"btn border-none btn-animated flex-1 font-semibold rounded-lg",style:{backgroundColor:"#dc2626",color:"#EEEEEE"},onClick:A,disabled:c,children:c?t.jsx("span",{className:"loading loading-spinner"}):"Yes, Delete"}),t.jsx("button",{className:"btn border-none btn-animated flex-1 font-semibold rounded-lg",style:{backgroundColor:"#393E46",color:"#EEEEEE"},onClick:()=>m(!1),disabled:c,children:"Cancel"})]})]})})]})},is=()=>{const[e,s]=u.useState([]);return u.useEffect(()=>{const n=setInterval(()=>{const r=["â„","âœ¦","âœ§","â‹†","âˆ˜","â—¦"],a={id:Math.random(),left:Math.random()*100,animationDuration:Math.random()*8+5,size:Math.random()*.8+.6,symbol:r[Math.floor(Math.random()*r.length)],delay:Math.random()*2};s(l=>[...l,a]),setTimeout(()=>{s(l=>l.filter(i=>i.id!==a.id))},(a.animationDuration+a.delay)*1e3)},800);return()=>clearInterval(n)},[]),t.jsx("div",{className:"fixed inset-0 pointer-events-none",style:{zIndex:-1},children:e.map(o=>t.jsx("div",{className:"snowdrop",style:{left:`${o.left}%`,fontSize:`${o.size}em`,animationDuration:`${o.animationDuration}s`,animationDelay:`${o.delay}s`,zIndex:-1},children:o.symbol},o.id))})};function cs(){const{authUser:e}=S();return t.jsxs("div",{className:"p-4 min-h-screen flex items-center justify-center sm:p-6 md:p-8 lg:p-10 relative",style:{zIndex:1},children:[t.jsx(is,{}),t.jsx("div",{className:"relative z-20",children:t.jsxs(we,{children:[t.jsx($,{path:"/",element:e?t.jsx(ns,{}):t.jsx(F,{to:"/login"})}),t.jsx($,{path:"/login",element:e?t.jsx(F,{to:"/"}):t.jsx(St,{})}),t.jsx($,{path:"/signup",element:e?t.jsx(F,{to:"/"}):t.jsx(Mt,{})}),t.jsx($,{path:"/profile",element:e?t.jsx(ls,{}):t.jsx(F,{to:"/login"})})]})}),t.jsx(wt,{toastOptions:{className:"",style:{zIndex:100}}})]})}Ae.createRoot(document.getElementById("root")).render(t.jsx(u.StrictMode,{children:t.jsx(Ne,{children:t.jsx(Re,{children:t.jsx(_t,{children:t.jsx(cs,{})})})})}));
